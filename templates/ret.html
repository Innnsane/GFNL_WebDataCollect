<html>
    <head>
        <title>基础检索数据提交 | 绿洲气象观测站</title>
        <script type="text/javascript" src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/blueimp-md5/2.18.0/js/md5.min.js"></script>
        <script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/semantic-ui/2.4.1/semantic.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/semantic-ui/2.4.1/semantic.min.css">
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-RNLTT6XCXN"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-RNLTT6XCXN');
        </script>
        <style>
            body {
                text-align: center;
            }
            .itemDiv {
                position: relative;
                display: inline-block;
                margin: 5px;
            }

            .itemText {
                font-size: 12px;
            }

            .itemIcon {
                position: relative;
                display: inline-block;
                aspect-ratio: auto 1 / 1;
                font-size: 2rem;
                width: 80px;
                min-width: 64px;
                cursor: pointer;
                user-select: none;
            }

            .itemIcon .overlay {  
                clip-path: polygon(91.92% 0%,8.08% 0%,0% 8.08%,0% 91.92%,8.08% 100%,91.92% 100%,100% 91.92%,100% 8.08%);
                position: absolute;
                width: 100%;
                height: 100%;
                z-index: 4;
            }
            
            .itemIcon .overlay::before {
                content: "";
                width: 50%;
                height: 50%;
                display: block;
                position: absolute;
                left: 0;
                top: 0;
                background-image: linear-gradient(135deg,rgb(0 0 0 / 70%) 50%,transparent 50%);
                z-index: 0;
            }

            .itemIcon .subicon.tl {
                left: 3%;
                top: 3%;
                width: 25%;
                height: 25%;
                background-repeat: no-repeat;
                background-size: contain;
                background-position: center;
            }

            .itemIcon .subicon {
                z-index: 10;
                position: absolute;
                height: auto;
            }

            .itemIcon .mainicon {
                z-index: 0;
                height: auto;
                width: 100%;
                position: relative;
                z-index: 1;
                background-size: 100%;
                background-repeat: no-repeat;
                background-position: center;
                clip-path: polygon(8.83% 97.50%,2.50% 91.17%,2.50% 8.83%,8.83% 2.50%,91.16% 2.50%,97.49% 8.83%,97.49% 91.16%,91.16% 97.49%,8.83% 97.49%);
            }

            .itemIcon .plate {
                clip-path: polygon(8.83% 97.50%,2.50% 91.17%,2.50% 8.83%,8.83% 2.50%,91.16% 2.50%,97.49% 8.83%,97.49% 91.16%,91.16% 97.49%,8.83% 97.49%);
                position: absolute;
                background-image: radial-gradient(circle,transparent 60%,rgb(0 0 0 / 50%) 150%);
                display: block;
                width: 100%;
                height: 100%;
                top: 0;
                left: 0px;
                z-index: 0;
            }
            
            .itemIcon .back {
                clip-path: polygon(91.92% 0.00%,8.08% 0.00%,0.00% 8.08%,0.00% 91.92%,8.08% 100.00%,42.19% 100.00%,42.19% 96.87%,9.38% 96.87%,3.13% 90.62%,3.13% 9.38%,9.38% 3.13%,90.63% 3.13%,96.88% 9.38%,96.88% 90.63%,90.63% 96.88%,42.19% 96.88%,42.19% 100.00%,91.92% 100.00%,100.00% 91.92%,100.00% 8.08%,91.92% 0.00%);
                position: absolute;
                display: block;
                width: 100%;
                height: 100%;
                top: 0;
                left: 0px;
                z-index: 3;
            }

            .itemIcon.rarity1 .back {background-color:#7D7D7D}
            .itemIcon.rarity1 .plate {background-color:#606060}
            .itemIcon.rarity1.blend .subicon.tl{filter:url(#blendColor1)}
            .itemIcon.rarity2 .back {background-color:#60c030}
            .itemIcon.rarity2 .plate {background-color:#507040}
            .itemIcon.rarity2.blend .subicon.tl{filter:url(#blendColor2)}
            .itemIcon.rarity3 .back {background-color:#5CB7EC}
            .itemIcon.rarity3 .plate {background-color:#256070}
            .itemIcon.rarity3.blend .subicon.tl{filter:url(#blendColor3)}
            .itemIcon.rarity4 .back {background-color:#BA77FF}
            .itemIcon.rarity4 .plate {background-color:#6C4466}
            .itemIcon.rarity4.blend .subicon.tl{filter:url(#blendColor4)}
            .itemIcon.rarity5 .back {background-color:#FF8000}
            .itemIcon.rarity5 .plate {background-color:#805530}
            .itemIcon.rarity5.blend .subicon.tl{filter:url(#blendColor5)}

            .itemNumber {
                text-align: center;
                clip-path: polygon(0% 0%,100% 0%,100% 60%,80% 100%,0% 100%,0% 0%);
                position: absolute;
                bottom: 1px;
                right: 1px;
                width: 45%;
                background-color: rgb(0 0 0 / 60%);
                z-index: 2;
                font-size: 14px;
                color: #eaeaea;
                font-family: sans-serif;
            }

            img.dollicon {
                height: auto;
                width: 100%;
                position: relative;
                z-index: 1;
                background-size: 100%;
                background-repeat: no-repeat;
                background-position: center;
            }

            .itemIcon.dollSquare.rarity5 {
                box-shadow: inset 10px -10px 20px -10px #cf6c07;
            }

            .itemIcon.dollSquare.rarity4 {
                box-shadow: inset 10px -10px 20px -10px #BA77FF;
            }

            .itemIcon.dollSquare.rarity3 {
                box-shadow: inset 10px -10px 20px -10px #5cb7ec;
            }

            div#itemDisplay {
                text-align: left;
                height: 400px;
                overflow-y: scroll;
                box-shadow: none;
                border: none;
                margin-top: 0px !important;
                margin-bottom: 0px !important;
            }

            div#itemChosen {
                box-shadow: none;
                border: none;
                min-height: 152px;
            }

            /* -- Semantic UI -- */
            input::-webkit-outer-spin-button,
            input::-webkit-inner-spin-button{
                -webkit-appearance: none !important;
                margin: 0;
            }

            input[type=number]{
                width: 100px;
            }

            .dollDisplay{
                text-align: left;
            }

            .ui.segment {
                width: 100%;
                max-width: 1000px;
                margin: 20px auto !important;
            }

            .ui.vertical.menu {
                width: 12rem;
            }

            .ui.compact.segment {
                width: unset;
                margin: 0px 7px;
                margin-top: 10px;
                display: inline-block;
                float: none;
            }

            .ui.button {
                vertical-align: middle;
            }
            
            .ui.basic.label {
                width: 82px;
            }

            .floating.ui.circular.label {
                left: inherit;
                right: 100%;
                margin: 0em -1em 0em 0em !important;
            }

            .ui.field {
                margin: 10px;
            }
            .ui.modal .content{
                text-align: center;
            }

            .ui.menu.sidebar {
                text-align: left;
                font-size: 16px;
            }

            div#sidebarButton {
                float: left;
            }

            h1.ui.header {
                text-align: right;
                margin: auto;
            }
        </style>
    </head>
    <body>
        <div class="ui left vertical menu sidebar">
            <div class="item">
                <div class="header">绿洲气象观测站</div>
                <div class="menu">
                    <a class="item" href="/">首页</a>
                </div>
            </div>
            <div class="item">
                <div class="header">算法</div>
                <div class="menu">
                  <a class="item" href="/algorithm">数据提交</a>
                  <a class="item" href="/algorithm/query">掉落查询</a>
                  <a class="item" href="/algorithm/display">近期提交记录</a>
                </div>
            </div>
            <div class="item">
                <div class="header">心智碎片</div>
                <div class="menu">
                <a class="item" href="/mind">数据提交</a>
                <a class="item" href="/mind/display">数据展示</a>
                </div>
            </div>
            <div class="item">
                <div class="header">基础检索</div>
                <div class="menu">
                <a class="item" href="/retrieval">数据提交</a>
                </div>
            </div>
        </div>
        <div class="pusher">
            <div class="ui raised segment">
                <div class="ui basic button" id="sidebarButton">
                    <i class="th list icon"></i>
                    Menu
                </div>
                <h1 class="ui header">
                    <div class="content">
                        基础检索数据提交
                    </div>
                </h1>
            </div>
            <div class="ui raised segment">
                <div class="ui grid">
                    <div class="three wide column">
                        <div class="ui secondary vertical pointing menu">
                            <a class="active item itemType" id="itemType_doll">
                                角色
                            </a>
                            <a class="item itemType" id="itemType_mindf">
                                心智碎片
                            </a>
                            <a class="item itemType" id="itemType_minds">
                                心智构件
                            </a>
                            <a class="item itemType" id="itemType_factory">
                                工厂材料
                            </a>
                            <a class="item itemType" id="itemType_xp">
                                经验
                            </a>
                            <a class="item itemType" id="itemType_gift">
                                礼物
                            </a>
                            <a class="item itemType" id="itemType_ctrl">
                                突破控件
                            </a>
                            <!--
                                <div class="right menu">
                                    <div class="item">
                                        <div class="ui transparent icon input">
                                        <input type="text" placeholder="Search users...">
                                        <i class="search link icon"></i>
                                        </div>
                                    </div>
                                </div>
                            -->
                        </div>
                    </div>
                    <div class="thirteen wide stretched column">
                        <div class="ui segment" id="itemDisplay">
                            <p></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="ui raised segment">
                <div class="ui segment" id="itemChosen">
                    <p></p>
                </div>
                <div class="ui error message dataErrorMessage" style="display: none;">
                    <div class="header">提交失败</div>
                    <p>请填入十个</p>
                </div>
                <div class="ui section divider"></div>
                <button class="ui button" id="retrievalClear" onclick="retrievalDelete();">清空</button>
                <button class="ui primary button" id="retrievalSubmit">提交</button>
            </div>
            
            <!-- 下面是提示框的设计 -->
            <div class="ui tiny modal retrievalModal">
                <div class="ui icon header">
                    <i class="envelope icon"></i>Message
                </div>
                <div class="content">
                    <p>Your inbox is getting full, would you like us to enable automatic archiving of old messages?</p>
                </div>
                <div class="actions">
                <div class="ui green ok inverted button">
                    <i class="checkmark icon"></i>
                    Yes
                </div>
                </div>
            </div>
        </div>
    </body>
    <script>
        var work = {
            "1": "守卫",
            "2": "射手",
            "3": "战士",
            "4": "特种",
            "5": "医师",
        }
        var item = {
            "doll": {
                "doll_1008": {
                    "name": "琴",
                    "rarity": "5",
                    "card": "http://wiki.42lab.cloud/images/a/ab/Npic_gin.png",
                },
                "doll_1009": {
                    "name": "迈迈",
                    "rarity": "3",
                    "card": "http://wiki.42lab.cloud/images/4/4f/Npic_mai.png",
                },
                "doll_1013": {
                    "name": "贝蒂",
                    "rarity": "4",
                    "card": "http://wiki.42lab.cloud/images/9/9a/Npic_betty.png",
                },
                "doll_1016": {
                    "name": "坂口希",
                    "rarity": "5",
                    "card": "http://wiki.42lab.cloud/images/4/40/Npic_banxsy.png",
                },
                "doll_1017": {
                    "name": "安吉拉",
                    "rarity": "4",
                    "card": "http://wiki.42lab.cloud/images/f/f0/Npic_angela.png",
                },
                "doll_1023": {
                    "name": "波妮",
                    "rarity": "3",
                    "card": "http://wiki.42lab.cloud/images/e/e8/Npic_bonee.png",
                },
                "doll_1024": {
                    "name": "埃尔赫",
                    "rarity": "4",
                    "card": "http://wiki.42lab.cloud/images/1/1c/Npic_earhart.png",
                },
                "doll_1031": {
                    "name": "伊姆赫特",
                    "rarity": "4",
                    "card": "http://wiki.42lab.cloud/images/6/6f/Npic_imhotep.png",
                },
                "doll_1035": {
                    "name": "洁西",
                    "rarity": "3",
                    "card": "http://wiki.42lab.cloud/images/c/c6/Npic_jessie.png",
                }
            },
            "mindf": {
                "mindf_1001": {
                    "name": "帕斯卡",
                    "job": "5",
                },
                "mindf_1002": {
                    "name": "安冬妮娜",
                    "job": "4",
                },
                "mindf_1003": {
                    "name": "苏尔",
                    "job": "3",
                },
                "mindf_1004": {
                    "name": "席摩",
                    "job": "2",
                },
                "mindf_1005": {
                    "name": "克罗琦",
                    "job": "1",
                },
                "mindf_1006": {
                    "name": "菲涅尔",
                    "job": "2",
                },
                "mindf_1007": {
                    "name": "炽",
                    "job": "3",
                },
                "mindf_1008": {
                    "name": "琴",
                    "job": "5",
                },
                "mindf_1009": {
                    "name": "迈迈",
                    "job": "4",
                },
                "mindf_1010": {
                    "name": "伊芙琳",
                    "job": "1",
                },
                "mindf_1011": {
                    "name": "薮春",
                    "job": "1",
                },
                "mindf_1012": {
                    "name": "麦克斯",
                    "job": "2",
                },
                "mindf_1013": {
                    "name": "贝蒂",
                    "job": "3",
                },
                "mindf_1014": {
                    "name": "巧可",
                    "job": "5",
                },
                "mindf_1015": {
                    "name": "帕那刻亚",
                    "job": "5",
                },
                "mindf_1016": {
                    "name": "坂口希",
                    "job": "4",
                },
                "mindf_1017": {
                    "name": "安吉拉",
                    "job": "4",
                },
                "mindf_1018": {
                    "name": "芙洛伦",
                    "job": "5",
                },
                "mindf_1019": {
                    "name": "芬恩",
                    "job": "3",
                },
                "mindf_1020": {
                    "name": "扬尼",
                    "job": "1",
                },
                "mindf_1021": {
                    "name": "音流",
                    "job": "4",
                },
                "mindf_1022": {
                    "name": "秋",
                    "job": "3",
                },
                "mindf_1023": {
                    "name": "波妮",
                    "job": "1",
                },
                "mindf_1024": {
                    "name": "埃尔赫",
                    "job": "2",
                },
                "mindf_1025": {
                    "name": "缠枝",
                    "job": "2",
                },
                "mindf_1026": {
                    "name": "七花",
                    "job": "5",
                },
                "mindf_1027": {
                    "name": "希安",
                    "job": "1",
                },
                "mindf_1028": {
                    "name": "薇",
                    "job": "3",
                },
                "mindf_1029": {
                    "name": "薇洛儿",
                    "job": "4",
                },
                "mindf_1030": {
                    "name": "科谢尼娅",
                    "job": "4",
                },
                "mindf_1031": {
                    "name": "伊姆赫特",
                    "job": "5",
                },
                "mindf_1032": {
                    "name": "奥托金",
                    "job": "2",
                },
                "mindf_1033": {
                    "name": "莉丝",
                    "job": "4",
                },
                "mindf_1034": {
                    "name": "阿比盖尔",
                    "job": "4",
                },
                "mindf_1035": {
                    "name": "洁西",
                    "job": "5",
                },
                "mindf_1036": {
                    "name": "拉姆",
                    "job": "2",
                },
                "mindf_1037": {
                    "name": "赫波",
                    "job": "2",
                },
                "mindf_1038": {
                    "name": "咲耶",
                    "job": "4",
                },
                "mindf_1039": {
                    "name": "桑朵莱希",
                    "job": "3",
                },
                "mindf_1040": {
                    "name": "杜莎妮",
                    "job": "3",
                },
                "mindf_1041": {
                    "name": "德菈赛",
                    "job": "5",
                },
                "mindf_1042": {
                    "name": "初尘",
                    "job": "3",
                }
            },
            "minds": {
                "minds_1": {
                    "name": "心智构件×1",
                    "number": "1",
                },
                "minds_2": {
                    "name": "心智构件×2",
                    "number": "2",
                },
                "minds_4": {
                    "name": "心智构件×4",
                    "number": "4",
                }
            },
            "factory": {
                "factory_1_1": {
                    "name": "低模方形数据",
                    "rarity": "2"
                },
                "factory_1_2": {
                    "name": "低模三角数据",
                    "rarity": "2"
                },
                "factory_1_3": {
                    "name": "低模菱形数据",
                    "rarity": "2"
                },
                "factory_2_1": {
                    "name": "中模方形数据",
                    "rarity": "3"
                },
                "factory_2_2": {
                    "name": "中模三角数据",
                    "rarity": "3"
                },
                "factory_2_3": {
                    "name": "中模菱形数据",
                    "rarity": "3"
                },
                "factory_3_1": {
                    "name": "高模方形数据",
                    "rarity": "4"
                },
                "factory_3_2": {
                    "name": "高模三角数据",
                    "rarity": "4"
                },
                "factory_3_3": {
                    "name": "高模菱形数据",
                    "rarity": "4"
                },
            },
            "xp": {
                "xp_1_1": {
                    "name": "作战经验*100",
                    "number": "1",
                    "rarity": "3"
                },
                "xp_1_3": {
                    "name": "作战经验*100",
                    "number": "3",
                    "rarity": "3"
                },
                "xp_2_1": {
                    "name": "作战经验*600",
                    "number": "1",
                    "rarity": "4"
                },
                "xp_2_2": {
                    "name": "作战经验*600",
                    "number": "2",
                    "rarity": "4"
                },
                "xp_2_3": {
                    "name": "作战经验*600",
                    "number": "3",
                    "rarity": "4"
                },
                "xp_3_1": {
                    "name": "作战经验*3600",
                    "number": "1",
                    "rarity": "5"
                },
            },
            "gift": {
                "gift_1_1": {
                    "name": "包子",
                    "rarity": "3"
                },
                "gift_1_2": {
                    "name": "快餐",
                    "rarity": "3"
                },
                "gift_1_3": {
                    "name": "小块蛋糕",
                    "rarity": "3"
                },
                "gift_1_4": {
                    "name": "蜂蜜",
                    "rarity": "3"
                },
                "gift_1_5": {
                    "name": "关东煮",
                    "rarity": "3"
                },
                "gift_1_6": {
                    "name": "毛绒挂饰",
                    "rarity": "3"
                },
                "gift_1_7": {
                    "name": "数码积木",
                    "rarity": "3"
                },
                "gift_1_8": {
                    "name": "练习竹剑",
                    "rarity": "3"
                },
                "gift_2_1": {
                    "name": "一笼包子",
                    "rarity": "4"
                },
                "gift_2_2": {
                    "name": "工作套餐",
                    "rarity": "4"
                },
                "gift_2_3": {
                    "name": "加量蛋糕",
                    "rarity": "4"
                },
                "gift_2_4": {
                    "name": "巧克力圣代",
                    "rarity": "4"
                },
                "gift_2_5": {
                    "name": "草莓蛋糕",
                    "rarity": "4"
                },
                "gift_2_6": {
                    "name": "卡通玩偶",
                    "rarity": "4"
                },
                "gift_2_7": {
                    "name": "瓶中飞船",
                    "rarity": "4"
                },
                "gift_2_8": {
                    "name": "实用军刀",
                    "rarity": "4"
                },
                "gift_3_1": {
                    "name": "一屉包子",
                    "rarity": "5"
                },
                "gift_3_2": {
                    "name": "双人套餐",
                    "rarity": "5"
                },
                "gift_3_3": {
                    "name": "豪华蛋糕",
                    "rarity": "5"
                },
                "gift_3_4": {
                    "name": "咖啡",
                    "rarity": "5"
                },
                "gift_3_5": {
                    "name": "下午茶",
                    "rarity": "5"
                },
                "gift_3_6": {
                    "name": "玩具大熊",
                    "rarity": "5"
                },
                "gift_3_7": {
                    "name": "手办模型",
                    "rarity": "5"
                },
                "gift_3_8": {
                    "name": "典藏名刀",
                    "rarity": "5"
                },
            },
            "ctrl": {
                "ctrl_1_1":{
                    "name": "简化突破控件·守卫",
                    "rarity": "1"
                },
                "ctrl_1_2":{
                    "name": "简化突破控件·射手",
                    "rarity": "1"
                },
                "ctrl_1_3":{
                    "name": "简化突破控件·战士",
                    "rarity": "1"
                },
                "ctrl_1_4":{
                    "name": "简化突破控件·特种",
                    "rarity": "1"
                },
                "ctrl_1_5":{
                    "name": "简化突破控件·医师",
                    "rarity": "1"
                },
                "ctrl_2_1":{
                    "name": "标准突破控件·守卫",
                    "rarity": "2"
                },
                "ctrl_2_2":{
                    "name": "标准突破控件·射手",
                    "rarity": "2"
                },
                "ctrl_2_3":{
                    "name": "标准突破控件·战士",
                    "rarity": "2"
                },
                "ctrl_2_4":{
                    "name": "标准突破控件·特种",
                    "rarity": "2"
                },
                "ctrl_2_5":{
                    "name": "标准突破控件·医师",
                    "rarity": "2"
                },
                "ctrl_3_1":{
                    "name": "高级突破控件·守卫",
                    "rarity": "3"
                },
                "ctrl_3_2":{
                    "name": "高级突破控件·射手",
                    "rarity": "3"
                },
                "ctrl_3_3":{
                    "name": "高级突破控件·战士",
                    "rarity": "3"
                },
                "ctrl_3_4":{
                    "name": "高级突破控件·特种",
                    "rarity": "3"
                },
                "ctrl_3_5":{
                    "name": "高级突破控件·医师",
                    "rarity": "3"
                },
                "ctrl_4_1":{
                    "name": "特级突破控件·守卫",
                    "rarity": "4"
                },
                "ctrl_4_2":{
                    "name": "特级突破控件·射手",
                    "rarity": "4"
                },
                "ctrl_4_3":{
                    "name": "特级突破控件·战士",
                    "rarity": "4"
                },
                "ctrl_4_4":{
                    "name": "特级突破控件·特种",
                    "rarity": "4"
                },
                "ctrl_4_5":{
                    "name": "特级突破控件·医师",
                    "rarity": "4"
                },
                "ctrl_5_1":{
                    "name": "尖端突破控件·守卫",
                    "rarity": "5"
                },
                "ctrl_5_2":{
                    "name": "尖端突破控件·射手",
                    "rarity": "5"
                },
                "ctrl_5_3":{
                    "name": "尖端突破控件·战士",
                    "rarity": "5"
                },
                "ctrl_5_4":{
                    "name": "尖端突破控件·特种",
                    "rarity": "5"
                },
                "ctrl_5_5":{
                    "name": "尖端突破控件·医师",
                    "rarity": "5"
                },
            }
        }
        

        initial();
        function initial(){
            $('.ui.modal').modal();
            $("#retrievalSubmit").click(retrievalSubmit);

            /* itemType chose */
            $(".itemType").click(function(){
                $(".itemType").removeClass("active");
                $(this).addClass("active");
                itemTypeAllCreate();
            });
            $("#itemType_gift").click();

            /* sidebar */
            $("#sidebarButton").click(function(){
                $('.menu.sidebar').sidebar('setting', 'transition', 'overlay').sidebar('toggle');
            });
        }

        itemTypeAllCreate();
        function itemTypeAllCreate(){
            let itemType = $(".itemType.active").attr("id");
            let dom = ``;
            
            switch(itemType){
                case "itemType_doll":{
                    for(let id in item.doll){
                        dom += dollSquareCreate(id, item["doll"][id]["name"], item["doll"][id]["card"], false, item["doll"][id]["rarity"], false);
                    }
                } break;
                case "itemType_mindf":{
                    for(let id in item.mindf){
                        let img_name = "ICON_Item_" + String(Number(id.split("_")[1]) + 1000) + ".png";
                        let img_md5 = md5(img_name).slice(0,2);
                        let img_path = `http://wiki.42lab.cloud/images/${img_md5[0]}/${img_md5}/${img_name}`;
                        let icon_path = "http://wiki.42lab.cloud/images/3/3f/%E9%80%9A%E7%94%A8_%E7%A2%8E%E7%89%87.png";
                        dom += itemSquareCreate(id, "心智碎片", img_path, 1, 4, icon_path);
                    }
                } break;
                case "itemType_minds":{
                    for(let id in item.minds){
                        let img_path = `http://wiki.42lab.cloud/images/a/a7/ICON_Item_%E5%BF%83%E6%99%BA%E6%9E%84%E4%BB%B6.png`;
                        let icon_path = "http://wiki.42lab.cloud/images/1/10/ICON_small_Item_%E5%BF%83%E6%99%BA%E6%9E%84%E4%BB%B6.png";
                        dom += itemSquareCreate(id, item["minds"][id]["name"], img_path, item["minds"][id]["number"], 5, icon_path);
                    }
                } break;
                case "itemType_factory":{
                    let last_rarity = "2";
                    for(let id in item.factory){
                        let img_name = "ICON_Item_" + item["factory"][id]["name"] + ".png";
                        let img_md5 = md5(img_name).slice(0,2);
                        let img_path = `http://wiki.42lab.cloud/images/${img_md5[0]}/${img_md5}/${img_name}`;
                        
                        if(last_rarity != item["factory"][id]["rarity"]) dom += "<br/>"
                        dom += itemSquareCreate(id, item["factory"][id]["name"], img_path, 5, item["factory"][id]["rarity"], false);
                        last_rarity = item["factory"][id]["rarity"];
                    }
                } break;
                case "itemType_xp":{
                    for(let id in item.xp){
                        let img_name = "ICON_Item_" + item["xp"][id]["name"] + ".png";
                        let img_md5 = md5(img_name).slice(0,2);
                        let img_path = `http://wiki.42lab.cloud/images/${img_md5[0]}/${img_md5}/${img_name}`;
                        let icon_path = "http://wiki.42lab.cloud/images/3/3d/ICON_small_Item_%E4%BD%9C%E6%88%98%E7%BB%8F%E9%AA%8C_2.png";
                        dom += itemSquareCreate(id, item["xp"][id]["name"], img_path, item["xp"][id]["number"], item["xp"][id]["rarity"], icon_path);
                    }
                } break;
                case "itemType_gift":{
                    let last_rarity = "3";
                    for(let id in item.gift){
                        let img_name = "Icon_gift_" + item["gift"][id]["name"] + ".png";
                        let img_md5 = md5(img_name).slice(0,2);
                        let img_path = `http://wiki.42lab.cloud/images/${img_md5[0]}/${img_md5}/${img_name}`;
                        if(last_rarity != item["gift"][id]["rarity"]) dom += "<br/>"
                        dom += itemSquareCreate(id, item["gift"][id]["name"], img_path, 1, item["gift"][id]["rarity"], false);
                        last_rarity = item["gift"][id]["rarity"];
                    }
                } break;
                case "itemType_ctrl":{
                    let last_rarity = "1";
                    for(let id in item.ctrl){
                        let img_name = "ICON_Item_" + item["ctrl"][id]["name"] + ".png";
                        let img_md5 = md5(img_name).slice(0,2);
                        let img_path = `http://wiki.42lab.cloud/images/${img_md5[0]}/${img_md5}/${img_name}`;
                        
                        let icon_name = "ICON_small_Item_" + item["ctrl"][id]["name"].slice(2, item["ctrl"][id]["name"].length) + ".png";
                        let icon_md5 = md5(icon_name).slice(0,2);
                        let icon_path = `http://wiki.42lab.cloud/images/${icon_md5[0]}/${icon_md5}/${icon_name}`;

                        if(last_rarity != item["ctrl"][id]["rarity"]) dom += "<br/>"
                        dom += itemSquareCreate( id, item["ctrl"][id]["name"], img_path, 1, item["ctrl"][id]["rarity"], icon_path);
                        last_rarity = item["ctrl"][id]["rarity"];
                    }
                } break;
            }

            $("#itemDisplay").html(dom);

            $("#itemDisplay").children(".itemDiv").children(".itemIcon").click(function(){
                let square = $(this).parent(".itemDiv").html();
                $("#itemChosen").append(`<div class="itemDiv">${square}<div class="floating ui black label">0</div></div>`);
                $("#itemChosen").children(".itemDiv").children(".itemIcon").unbind("click").click(function(){
                    $(this).parent(".itemDiv").remove();
                    dollLabelCreate();
                });
                dollLabelCreate();
            });
        }

        function itemSquareCreate(id, text, img, num, rarity, icon){
            return `
            <div class="itemDiv">
                <div class="itemIcon rarity${rarity}" data-id="${id}">
                    ${(icon) ? `<div class="overlay">
                        <img src="http://wiki.42lab.cloud/images/d/d2/Blank.png" class="subicon tl" style="background-image:url(${icon})" />
                    </div>` : ``}
                    <a><img alt="${text}" class="mainicon" src="http://wiki.42lab.cloud/images/d/d2/Blank.png" style="background-image:url(${img})">
                        <div class="plate"></div>
                        <div class="back"></div>
                    </a>
                    <div class="itemNumber">${num}</div>
                </div>
                <div class="itemText">${text}</div>
            </div>`;
        }

        function dollSquareCreate(id, text, img, num, rarity, icon){
            return `
            <div class="itemDiv">
                <div class="itemIcon dollSquare rarity${rarity}" data-id="${id}">
                    <a><img alt="${text}" class="dollicon" src="http://wiki.42lab.cloud/images/d/d2/Blank.png" style="background-image:url(${img})">
                    </a>
                </div>
                <div class="itemText">${text}</div>
            </div>`;
        }

        function dollLabelCreate(){
            let element = $("#itemChosen").children(".itemDiv");
            for(let i = 0; i < element.length; i++){
                $(element[i]).children(".floating.label").html(i + 1);
            }
        }

        function retrievalDelete(){
            $("#itemChosen").children(".itemDiv").remove();
        }

        function retrievalSubmit(){
            $("#retrievalSubmit").unbind("click").addClass("loading");

            let dataPass = true;
            $(".ui.dataErrorMessage").addClass("error").hide();
            
            let element = $("#itemChosen").children(".itemDiv").children(".itemIcon");
            if(element.length != 10) dataPass = false;

            let data = [];
            for(let i = 0; i < element.length; i ++){
                let id = $(element[i]).data("id");
                data.push($(element[i]).data("id"));
                if(!(id in item[id.split("_")[0]])) {
                    dataPass = false
                }
            }

            console.log(data)
            if(!dataPass){
                $("#retrievalSubmit").removeClass("loading").click(retrievalSubmit);
                $(".ui.dataErrorMessage").fadeIn(200);
                $(".error").unbind("click").click(function(){
                    $(this).removeClass("error");
                });
                return
            }

            $.ajax({
                url: "retrieval/submit",
                type: "POST",
                data: {
                    "number": element.length, 
                    "get": JSON.stringify(data),
                },
                success: function (result) {
                    if(result.message == "success"){
                        retrievalDelete();
                        notice("提交成功，感谢教授的贡献！", "<i class='thumbs up icon'></i>Good Job, Professor!");
                    } else {
                        notice("提交失败，" + result.message, "<i class='exclamation triangle icon'></i>Error!");
                    }
                    $("#retrievalSubmit").removeClass("loading").click(retrievalSubmit);
                }
            });
        }

        function notice(text, icon){
            if(icon) $(".retrievalModal").children(".ui.icon.header").html(icon);
            $(".retrievalModal").children(".content").children("p").html(text);
            $('.ui.modal').modal('show');
        }
    </script>
</html>